<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <style>
    body {
      margin: 0;
      /* width: 100vw; */
      height: 100vh;
    }
    #btn {
        position: absolute;
        top: 100px;
        left: 100px;
        z-index: 1000;
    }#btn-1 {
        position: absolute;
        top: 100px;
        left: 200px;
        z-index: 1000;
    }
  </style>
  <body>
    <!-- <div> -->
      <canvas
        id="myCanvas"
        style="background-color: #eee;"
      ></canvas>
      <button id="btn-1" onclick="updrawLine()">添加辅助线</button>
    <!-- </div> -->

    <script>
        var point = [{
            startX:20,
            startY:20,
            endX:200,
            endY:200
        },{
            startX:550,
            startY:550,
            endX:230,
            endY:250
        },{
            startX:1120,
            startY:1120,
            endX:200,
            endY:600
        },]

       window.onload = function drawLine() {
        var oC = document.getElementById("myCanvas");
        document.getElementById("myCanvas").setAttribute("width",window.innerWidth)
        document.getElementById("myCanvas").setAttribute("height",window.innerHeight)

        var oGC = oC.getContext("2d");
        if(point && point.length>0){
            point.forEach(point => {
                // oGC.beginPath();//清空当前路径
                oGC.moveTo(point.startX,point.startY);

                oGC.lineTo(point.endX,point.endY);

                oGC.stroke();
                oGC.closePath()
            })
        }
        

        
      };
      var flag = false;
      function updrawLine() {
        flag = true
        var oC = document.getElementById("myCanvas");

        var oGC = oC.getContext("2d");
            document.onmousedown = function (ev) {
                if(flag){
                    var ev = ev || window.event;

          oGC.beginPath();

          oGC.moveTo(ev.clientX - oC.offsetLeft, ev.clientY - oC.offsetTop);
          console.log('start',ev.clientX,ev.clientY,oC);

          document.onmousemove = function (ev) {
            var ev = ev || window.event;

            // oGC.lineTo(ev.clientX-oC.offsetLeft,ev.clientY-oC.offsetTop);

            // oGC.closePath();

            // oGC.stroke();
          };

          document.onmouseup = function () {
            var ev = ev || window.event;

            oGC.lineTo(ev.clientX - oC.offsetLeft, ev.clientY - oC.offsetTop);

            oGC.stroke();
            console.log(oGC);

            document.onmousemove = null;

            document.onmouseup = null;
            flag = false
            console.log('end',ev.clientX,ev.clientY,oC);
          };

                }
          
        };

        window.onload = function(){
            var oC = document.getElementById("myCanvas");

            var oGC = oC.getContext("2d");
            document.addEventListener('click',function(ev){
                alert(1)
                if(oGC.isPointInPath(ev.clientX,ev.clientY)){
                    alert(true)
                } else {
                    alert(false)
                }
            })
        }
        
      }
    </script>
  </body>
</html>
